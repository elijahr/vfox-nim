#!/usr/bin/env bash
#MISE description="Run plugin tests - install and execute tool"
set -euo pipefail

mise plugin link --force nim .
mise cache clear
mise install nim@2.2.4

# Capture and display the output while also verifying it
output=$(mise exec "nim@2.2.4" -- "nim" --version)
echo "nim output: $output"

if echo "$output" | grep -q 'Nim Compiler Version 2.2.4'; then
  echo "✓ Tests passed"
else
  echo "✗ Test failed: expected 'Nim Compiler Version 2.2.4' in output"
  exit 1
fi
